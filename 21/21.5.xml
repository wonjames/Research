<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="C21.S5">
<title>Modular Transformations</title>        
 
<subsection xml:id="C21.S5.SS1">
<title>Riemann Theta Functions</title>        
  
<para xml:id="C21.S5.SS1.p1">

<sentence sentence-num-in-para="1" sentence-num-in-section="1" xml:id="C21.S5.SS1.p1.s1">
Let <Math mode="inline" xml:id="C21.S5.SS1.p1.m1">\mathbf{A}</Math> , <Math mode="inline" xml:id="C21.S5.SS1.p1.m2">\mathbf{B}</Math> , <Math mode="inline" xml:id="C21.S5.SS1.p1.m3">\mathbf{C}</Math> , and <Math mode="inline" xml:id="C21.S5.SS1.p1.m4">\mathbf{D}</Math> be <Math mode="inline" xml:id="C21.S5.SS1.p1.m5">g\times g</Math> matrices with integer elements such that <Math equation-number="21.5.1" mode="display" xml:id="C21.S5.E1">\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{A}&amp;\mathbf{B}\\ \mathbf{C}&amp;\mathbf{D}\end{bmatrix}</Math> is a symplectic matrix, that is, <Math equation-number="21.5.2" mode="display" xml:id="C21.S5.E2">\boldsymbol{{\Gamma}}\mathbf{J}_{2g}\boldsymbol{{\Gamma}}^{\mathrm{T}}=\mathbf {J}_{2g}</Math>.
</sentence>

<sentence sentence-num-in-para="2" sentence-num-in-section="2" xml:id="C21.S5.SS1.p1.s2">
Then <Math equation-number="21.5.3" mode="display" xml:id="C21.S5.E3">\det\boldsymbol{{\Gamma}}=1,</Math> and <Math equation-number="21.5.4" mode="display" xml:id="C21.S5.E4">\theta\left(\left[[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right]^{ \mathrm{T}}\mathbf{z}\middle|[\mathbf{A}\boldsymbol{{\Omega}}+\mathbf{B}][ \mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right)=\xi(\boldsymbol{{ \Gamma}})\sqrt{\det[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]}e^{\pi i \mathbf{z}\cdot\left[[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\mathbf{ C}\right]\cdot\mathbf{z}}\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}} \right)</Math>.
</sentence>

<sentence sentence-num-in-para="3" sentence-num-in-section="3" xml:id="C21.S5.SS1.p1.s3">
Here <Math mode="inline" xml:id="C21.S5.SS1.p1.m6">\xi(\boldsymbol{{\Gamma}})</Math> is an eighth root of unity, that is, <Math mode="inline" xml:id="C21.S5.SS1.p1.m7">(\xi(\boldsymbol{{\Gamma}}))^{8}=1</Math>.
</sentence>

<sentence sentence-num-in-para="4" sentence-num-in-section="4" xml:id="C21.S5.SS1.p1.s4">
For general <Math mode="inline" xml:id="C21.S5.SS1.p1.m8">\boldsymbol{{\Gamma}}</Math> , it is difficult to decide which root needs to be used. The choice depends on <Math mode="inline" xml:id="C21.S5.SS1.p1.m9">\boldsymbol{{\Gamma}}</Math> , but is independent of <Math mode="inline" xml:id="C21.S5.SS1.p1.m10">\mathbf{z}</Math> and <Math mode="inline" xml:id="C21.S5.SS1.p1.m11">\boldsymbol{{\Omega}}</Math>.
</sentence>

<sentence sentence-num-in-para="5" sentence-num-in-section="5" xml:id="C21.S5.SS1.p1.s5">
Equation (21.5.4) is the modular transformation property for Riemann theta functions.
</sentence>

</para>
 
<para xml:id="C21.S5.SS1.p2">

<sentence sentence-num-in-para="1" sentence-num-in-section="6" xml:id="C21.S5.SS1.p2.s1">
The modular transformations form a group under the composition of such transformations, the modular group, which is generated by simpler transformations, for which <Math mode="inline" xml:id="C21.S5.SS1.p2.m1">\xi(\boldsymbol{{\Gamma}})</Math> is determinate: <Math equation-number="21.5.5" mode="display" xml:id="C21.S5.E5">\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{A}&amp;\boldsymbol{{0}}_{g}\\ \boldsymbol{{0}}_{g}&amp;[\mathbf{A}^{-1}]^{\mathrm{T}}\end{bmatrix}\Rightarrow \theta\left(\mathbf{A}\mathbf{z}\middle|\mathbf{A}\boldsymbol{{\Omega}}\mathbf {A}^{\mathrm{T}}\right)=\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}} \right)</Math>.
</sentence>

<sentence sentence-num-in-para="2" sentence-num-in-section="7" xml:id="C21.S5.SS1.p2.s2">
( <Math mode="inline" xml:id="C21.S5.SS1.p2.m2">\mathbf{A}</Math> invertible with integer elements.)
</sentence>

<sentence sentence-num-in-para="3" sentence-num-in-section="8" xml:id="C21.S5.SS1.p2.s3">
<Math equation-number="21.5.6" mode="display" xml:id="C21.S5.E6">\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{I}_{g}&amp;\mathbf{B}\\ \boldsymbol{{0}}_{g}&amp;\mathbf{I}_{g}\end{bmatrix}\Rightarrow\theta\left(\mathbf {z}\middle|\boldsymbol{{\Omega}}+\mathbf{B}\right)=\theta\left(\mathbf{z} \middle|\boldsymbol{{\Omega}}\right)</Math>.
</sentence>

<sentence sentence-num-in-para="4" sentence-num-in-section="9" xml:id="C21.S5.SS1.p2.s4">
( <Math mode="inline" xml:id="C21.S5.SS1.p2.m3">\mathbf{B}</Math> symmetric with integer elements and even diagonal elements.)
</sentence>

<sentence sentence-num-in-para="5" sentence-num-in-section="10" xml:id="C21.S5.SS1.p2.s5">
<Math equation-number="21.5.7" mode="display" xml:id="C21.S5.E7">\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{I}_{g}&amp;\mathbf{B}\\ \boldsymbol{{0}}_{g}&amp;\mathbf{I}_{g}\end{bmatrix}\Rightarrow\theta\left(\mathbf {z}\middle|\boldsymbol{{\Omega}}+\mathbf{B}\right)=\theta\left(\mathbf{z}+ \tfrac{1}{2}\operatorname{diag}\mathbf{B}\middle|\boldsymbol{{\Omega}}\right)</Math>.
</sentence>

<sentence sentence-num-in-para="6" sentence-num-in-section="11" xml:id="C21.S5.SS1.p2.s6">
( <Math mode="inline" xml:id="C21.S5.SS1.p2.m4">\mathbf{B}</Math> symmetric with integer elements.)SeeHeil (1995, p. 24).
</sentence>

<sentence sentence-num-in-para="7" sentence-num-in-section="12" xml:id="C21.S5.SS1.p2.s7">
For a <Math mode="inline" xml:id="C21.S5.SS1.p2.m5">g\times g</Math> matrix <Math mode="inline" xml:id="C21.S5.SS1.p2.m6">{\bf A}</Math> we define <Math mode="inline" xml:id="C21.S5.SS1.p2.m7">\operatorname{diag}\mathbf{A}</Math> , as a column vector with the diagonal entries as elements.
</sentence>

<sentence sentence-num-in-para="8" sentence-num-in-section="13" xml:id="C21.S5.SS1.p2.s8">
<Math equation-number="21.5.8" mode="display" xml:id="C21.S5.E8">\boldsymbol{{\Gamma}}=\begin{bmatrix}\boldsymbol{{0}}_{g}&amp;-\mathbf{I}_{g}\\ \mathbf{I}_{g}&amp;\boldsymbol{{0}}_{g}\end{bmatrix}, ⇒ ⇒  \theta\left(\boldsymbol{{\Omega}}^{-1}\mathbf{z}\middle|-\boldsymbol{{\Omega}} ^{-1}\right)=\sqrt{\det\left[-i\boldsymbol{{\Omega}}\right]}e^{\pi i\mathbf{z} \cdot\boldsymbol{{\Omega}}^{-1}\cdot\mathbf{z}}\theta\left(\mathbf{z}\middle| \boldsymbol{{\Omega}}\right),</Math> where the square root assumes its principal value.
</sentence>

</para>

 
 
</subsection>
 
<subsection xml:id="C21.S5.SS2">
<title>Riemann Theta Functions with Characteristics</title>          
<para xml:id="C21.S5.SS2.p1">

<sentence sentence-num-in-para="1" sentence-num-in-section="14" xml:id="C21.S5.SS2.p1.s1">
 <Math equation-number="21.5.9" mode="display" xml:id="C21.S5.E9">\theta\genfrac{[}{]}{0.0pt}{}{\mathbf{D}\boldsymbol{{\alpha}}-\mathbf{C} \boldsymbol{{\beta}}+\tfrac{1}{2}\operatorname{diag}[\mathbf{C}\mathbf{D}^{ \mathrm{T}}]}{-\mathbf{B}\boldsymbol{{\alpha}}+\mathbf{A}\boldsymbol{{\beta}}+ \tfrac{1}{2}\operatorname{diag}[\mathbf{A}\mathbf{B}^{\mathrm{T}}]}\left(\left [[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right]^{\mathrm{T}}\mathbf{ z}\middle|[\mathbf{A}\boldsymbol{{\Omega}}+\mathbf{B}][\mathbf{C}\boldsymbol{{ \Omega}}+\mathbf{D}]^{-1}\right)=\kappa(\boldsymbol{{\alpha}},\boldsymbol{{ \beta}},\boldsymbol{{\Gamma}})\sqrt{\det[\mathbf{C}\boldsymbol{{\Omega}}+ \mathbf{D}]}e^{\pi i\mathbf{z}\cdot\left[[\mathbf{C}\boldsymbol{{\Omega}}+ \mathbf{D}]^{-1}\mathbf{C}\right]\cdot\mathbf{z}}\theta\genfrac{[}{]}{0.0pt}{} {\boldsymbol{{\alpha}}}{\boldsymbol{{\beta}}}\left(\mathbf{z}\middle| \boldsymbol{{\Omega}}\right),</Math> 
</sentence>

</para>
 
 
<para xml:id="C21.S5.SS2.p2">

<sentence sentence-num-in-para="1" sentence-num-in-section="15" xml:id="C21.S5.SS2.p2.s1">
where <Math mode="inline" xml:id="C21.S5.SS2.p2.m1">\kappa(\boldsymbol{{\alpha}},\boldsymbol{{\beta}},\boldsymbol{{\Gamma}})</Math> is a complex number that depends on <Math mode="inline" xml:id="C21.S5.SS2.p2.m2">\boldsymbol{{\alpha}}</Math> , <Math mode="inline" xml:id="C21.S5.SS2.p2.m3">\boldsymbol{{\beta}}</Math> , and <Math mode="inline" xml:id="C21.S5.SS2.p2.m4">\boldsymbol{{\Gamma}}</Math>.
</sentence>

<sentence sentence-num-in-para="2" sentence-num-in-section="16" xml:id="C21.S5.SS2.p2.s2">
However, <Math mode="inline" xml:id="C21.S5.SS2.p2.m5">\kappa(\boldsymbol{{\alpha}},\boldsymbol{{\beta}},\boldsymbol{{\Gamma}})</Math> is independent of <Math mode="inline" xml:id="C21.S5.SS2.p2.m6">\mathbf{z}</Math> and <Math mode="inline" xml:id="C21.S5.SS2.p2.m7">\boldsymbol{{\Omega}}</Math>.
</sentence>

<sentence sentence-num-in-para="3" sentence-num-in-section="17" xml:id="C21.S5.SS2.p2.s3">
For explicit results in the case <Math mode="inline" xml:id="C21.S5.SS2.p2.m8">g=1</Math> , see §20.7(viii).
</sentence>

</para>
  
</subsection>
 
</section>
