<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="C21.S6">
<title>Products</title>        
  
<subsection xml:id="C21.S6.SS1">
<title>Riemann Identity</title>        
    
<para xml:id="C21.S6.SS1.p1">

<sentence sentence-num-in-para="1" sentence-num-in-section="1" xml:id="C21.S6.SS1.p1.s1">
Let <Math mode="inline" xml:id="C21.S6.SS1.p1.m1">\mathbf{T}=[T_{jk}]</Math> be an arbitrary <Math mode="inline" xml:id="C21.S6.SS1.p1.m2">h\times h</Math> orthogonal matrix (that is, <Math mode="inline" xml:id="C21.S6.SS1.p1.m3">\mathbf{T}\mathbf{T}^{\mathrm{T}}=\mathbf{I}</Math> ) with rational elements.
</sentence>

<sentence sentence-num-in-para="2" sentence-num-in-section="2" xml:id="C21.S6.SS1.p1.s2">
Also, let <Math mode="inline" xml:id="C21.S6.SS1.p1.m4">\mathbf{Z}</Math> be an arbitrary <Math mode="inline" xml:id="C21.S6.SS1.p1.m5">g\times h</Math> matrix.
</sentence>

<sentence sentence-num-in-para="3" sentence-num-in-section="3" xml:id="C21.S6.SS1.p1.s3">
Define <Math equation-number="21.6.1" mode="display" xml:id="C21.S6.E1">\mathcal{K}={\mathbb{Z}^{g\times h}}\mathbf{T}/({\mathbb{Z}^{g\times h}} \mathbf{T}\cap{\mathbb{Z}^{g\times h}}),</Math> that is, <Math mode="inline" xml:id="C21.S6.SS1.p1.m6">\mathcal{K}</Math> is the set of all <Math mode="inline" xml:id="C21.S6.SS1.p1.m7">g\times h</Math> matrices that are obtained by premultiplying <Math mode="inline" xml:id="C21.S6.SS1.p1.m8">\mathbf{T}</Math> by any <Math mode="inline" xml:id="C21.S6.SS1.p1.m9">g\times h</Math> matrix with integer elements; two such matrices in <Math mode="inline" xml:id="C21.S6.SS1.p1.m10">\mathcal{K}</Math> are considered equivalent if their difference is a matrix with integer elements.
</sentence>

<sentence sentence-num-in-para="4" sentence-num-in-section="4" xml:id="C21.S6.SS1.p1.s4">
Also, let <Math equation-number="21.6.2" mode="display" xml:id="C21.S6.E2">\mathcal{D}=|\mathbf{T}^{\mathrm{T}}{\mathbb{Z}^{h}}/(\mathbf{T}^{\mathrm{T}}{ \mathbb{Z}^{h}}\cap{\mathbb{Z}^{h}})|,</Math> that is, <Math mode="inline" xml:id="C21.S6.SS1.p1.m11">\mathcal{D}</Math> is the number of elements in the set containing all <Math mode="inline" xml:id="C21.S6.SS1.p1.m12">h</Math> -dimensional vectors obtained by multiplying <Math mode="inline" xml:id="C21.S6.SS1.p1.m13">\mathbf{T}^{\mathrm{T}}</Math> on the right by a vector with integer elements.
</sentence>

<sentence sentence-num-in-para="5" sentence-num-in-section="5" xml:id="C21.S6.SS1.p1.s5">
Two such vectors are consideredequivalent if their difference is a vector with integer elements.
</sentence>

<sentence sentence-num-in-para="6" sentence-num-in-section="6" xml:id="C21.S6.SS1.p1.s6">
Then <Math equation-number="21.6.3" mode="display" xml:id="C21.S6.E3">\prod_{j=1}^{h}\theta\left(\sum_{k=1}^{h}T_{jk}\mathbf{z}_{k}\middle| \boldsymbol{{\Omega}}\right)=\frac{1}{\mathcal{D}^{g}}\sum_{\mathbf{A}\in \mathcal{K}}\sum_{\mathbf{B}\in\mathcal{K}}e^{2\pi i\operatorname{tr}\left[ \frac{1}{2}\mathbf{A}^{\mathrm{T}}\boldsymbol{{\Omega}}\mathbf{A}+\mathbf{A}^{ \mathrm{T}}[\mathbf{Z}+\mathbf{B}]\right]}\*\prod_{j=1}^{h}\theta\left(\mathbf {z}_{j}+\boldsymbol{{\Omega}}\mathbf{a}_{j}+\mathbf{b}_{j}\middle|\boldsymbol{ {\Omega}}\right),</Math> where <Math mode="inline" xml:id="C21.S6.SS1.p1.m14">\mathbf{z}_{j}</Math> , <Math mode="inline" xml:id="C21.S6.SS1.p1.m15">\mathbf{a}_{j}</Math> , <Math mode="inline" xml:id="C21.S6.SS1.p1.m16">\mathbf{b}_{j}</Math> denote respectively the <Math mode="inline" xml:id="C21.S6.SS1.p1.m17">j</Math> th columns of <Math mode="inline" xml:id="C21.S6.SS1.p1.m18">\mathbf{Z}</Math> , <Math mode="inline" xml:id="C21.S6.SS1.p1.m19">\mathbf{A}</Math> , <Math mode="inline" xml:id="C21.S6.SS1.p1.m20">\mathbf{B}</Math>.
</sentence>

<sentence sentence-num-in-para="7" sentence-num-in-section="7" xml:id="C21.S6.SS1.p1.s7">
This is theRiemann identity.
</sentence>

<sentence sentence-num-in-para="8" sentence-num-in-section="8" xml:id="C21.S6.SS1.p1.s8">
On using theta functions with characteristics, it becomes <Math equation-number="21.6.4" mode="display" xml:id="C21.S6.E4">\prod_{j=1}^{h}\theta\genfrac{[}{]}{0.0pt}{}{\sum_{k=1}^{h}T_{jk}\mathbf{c}_{k }}{\sum_{k=1}^{h}T_{jk}\mathbf{d}_{k}}\left(\sum_{k=1}^{h}T_{jk}\mathbf{z}_{k} \middle|\boldsymbol{{\Omega}}\right)=\frac{1}{\mathcal{D}^{g}}\sum_{\mathbf{A} \in\mathcal{K}}\sum_{\mathbf{B}\in\mathcal{K}}e^{-2\pi i\sum_{j=1}^{h}\mathbf{ b}_{j}\cdot\mathbf{c}_{j}}\prod_{j=1}^{h}\theta\genfrac{[}{]}{0.0pt}{}{\mathbf {a}_{j}+\mathbf{c}_{j}}{\mathbf{b}_{j}+\mathbf{d}_{j}}\left(\mathbf{z}_{j} \middle|\boldsymbol{{\Omega}}\right),</Math> where <Math mode="inline" xml:id="C21.S6.SS1.p1.m21">\mathbf{c}_{j}</Math> and <Math mode="inline" xml:id="C21.S6.SS1.p1.m22">\mathbf{d}_{j}</Math> are arbitrary <Math mode="inline" xml:id="C21.S6.SS1.p1.m23">h</Math> -dimensional vectors.
</sentence>

<sentence sentence-num-in-para="9" sentence-num-in-section="9" xml:id="C21.S6.SS1.p1.s9">
Many identities involving products of theta functions can be established using these formulas.
</sentence>

</para>
 
<paragraph xml:id="C21.S6.Px1">
<title>Example</title>   
<para xml:id="C21.S6.Px1.p1">

<sentence sentence-num-in-para="1" sentence-num-in-section="10" xml:id="C21.S6.Px1.p1.s1">
Let <Math mode="inline" xml:id="C21.S6.Px1.p1.m1">h=4</Math> and <Math equation-number="21.6.5" mode="display" xml:id="C21.S6.E5">\mathbf{T}=\frac{1}{2}\begin{bmatrix}1&amp;1&amp;1&amp;1\\ 1&amp;1&amp;-1&amp;-1\\ 1&amp;-1&amp;1&amp;-1\\ 1&amp;-1&amp;-1&amp;1\end{bmatrix}</Math>.
</sentence>

<sentence sentence-num-in-para="2" sentence-num-in-section="11" xml:id="C21.S6.Px1.p1.s2">
Then
</sentence>

</para>
  
<para xml:id="C21.S6.Px1.p2">

<sentence sentence-num-in-para="1" sentence-num-in-section="12" xml:id="C21.S6.Px1.p2.s1">
 <Math equation-number="21.6.6" mode="display" xml:id="C21.S6.E6">\theta\left(\frac{\mathbf{x}+\mathbf{y}+\mathbf{u}+\mathbf{v}}{2}\middle| \boldsymbol{{\Omega}}\right)\theta\left(\frac{\mathbf{x}+\mathbf{y}-\mathbf{u} -\mathbf{v}}{2}\middle|\boldsymbol{{\Omega}}\right)\theta\left(\frac{\mathbf{x }-\mathbf{y}+\mathbf{u}-\mathbf{v}}{2}\middle|\boldsymbol{{\Omega}}\right) \theta\left(\frac{\mathbf{x}-\mathbf{y}-\mathbf{u}+\mathbf{v}}{2}\middle| \boldsymbol{{\Omega}}\right)=\frac{1}{2^{g}}\sum_{\boldsymbol{{\alpha}}\in \frac{1}{2}{\mathbb{Z}^{g}}/{\mathbb{Z}^{g}}}\,\sum_{\boldsymbol{{\beta}}\in \frac{1}{2}{\mathbb{Z}^{g}}/{\mathbb{Z}^{g}}}e^{2\pi i\left(2\boldsymbol{{ \alpha}}\cdot\boldsymbol{{\Omega}}\cdot\boldsymbol{{\alpha}}+\boldsymbol{{ \alpha}}\cdot[\mathbf{x}+\mathbf{y}+\mathbf{u}+\mathbf{v}]\right)}\*\theta \left(\mathbf{x}+\boldsymbol{{\Omega}}\boldsymbol{{\alpha}}+\boldsymbol{{\beta }}\middle|\boldsymbol{{\Omega}}\right)\theta\left(\mathbf{y}+\boldsymbol{{ \Omega}}\boldsymbol{{\alpha}}+\boldsymbol{{\beta}}\middle|\boldsymbol{{\Omega} }\right)\theta\left(\mathbf{u}+\boldsymbol{{\Omega}}\boldsymbol{{\alpha}}+ \boldsymbol{{\beta}}\middle|\boldsymbol{{\Omega}}\right)\theta\left(\mathbf{v} +\boldsymbol{{\Omega}}\boldsymbol{{\alpha}}+\boldsymbol{{\beta}}\middle| \boldsymbol{{\Omega}}\right),</Math> and <Math equation-number="21.6.7" mode="display" xml:id="C21.S6.E7">\theta\genfrac{[}{]}{0.0pt}{}{\tfrac{1}{2}[\mathbf{c}_{1}+\mathbf{c}_{2}+ \mathbf{c}_{3}+\mathbf{c}_{4}]}{\tfrac{1}{2}[\mathbf{d}_{1}+\mathbf{d}_{2}+ \mathbf{d}_{3}+\mathbf{d}_{4}]}\left(\frac{\mathbf{x}+\mathbf{y}+\mathbf{u}+ \mathbf{v}}{2}\middle|\boldsymbol{{\Omega}}\right)\theta\genfrac{[}{]}{0.0pt}{ }{\tfrac{1}{2}[\mathbf{c}_{1}+\mathbf{c}_{2}-\mathbf{c}_{3}-\mathbf{c}_{4}]}{ \tfrac{1}{2}[\mathbf{d}_{1}+\mathbf{d}_{2}-\mathbf{d}_{3}-\mathbf{d}_{4}]} \left(\frac{\mathbf{x}+\mathbf{y}-\mathbf{u}-\mathbf{v}}{2}\middle|\boldsymbol {{\Omega}}\right)\*\theta\genfrac{[}{]}{0.0pt}{}{\tfrac{1}{2}[\mathbf{c}_{1}- \mathbf{c}_{2}+\mathbf{c}_{3}-\mathbf{c}_{4}]}{\tfrac{1}{2}[\mathbf{d}_{1}- \mathbf{d}_{2}+\mathbf{d}_{3}-\mathbf{d}_{4}]}\left(\frac{\mathbf{x}-\mathbf{y }+\mathbf{u}-\mathbf{v}}{2}\middle|\boldsymbol{{\Omega}}\right)\theta\genfrac{ [}{]}{0.0pt}{}{\tfrac{1}{2}[\mathbf{c}_{1}-\mathbf{c}_{2}-\mathbf{c}_{3}+ \mathbf{c}_{4}]}{\tfrac{1}{2}[\mathbf{d}_{1}-\mathbf{d}_{2}-\mathbf{d}_{3}+ \mathbf{d}_{4}]}\left(\frac{\mathbf{x}-\mathbf{y}-\mathbf{u}+\mathbf{v}}{2} \middle|\boldsymbol{{\Omega}}\right)\\ =\frac{1}{2^{g}}\sum_{\boldsymbol{{\alpha}}\in\frac{1}{2}{\mathbb{Z}^{g}}/{ \mathbb{Z}^{g}}}\,\sum_{\boldsymbol{{\beta}}\in\frac{1}{2}{\mathbb{Z}^{g}}/{ \mathbb{Z}^{g}}}e^{-2\pi i\boldsymbol{{\beta}}\cdot[\mathbf{c}_{1}+\mathbf{c}_ {2}+\mathbf{c}_{3}+\mathbf{c}_{4}]}\*\theta\genfrac{[}{]}{0.0pt}{}{\mathbf{c}_ {1}+\boldsymbol{{\alpha}}}{\mathbf{d}_{1}+\boldsymbol{{\beta}}}\left(\mathbf{x }\middle|\boldsymbol{{\Omega}}\right)\theta\genfrac{[}{]}{0.0pt}{}{\mathbf{c}_ {2}+\boldsymbol{{\alpha}}}{\mathbf{d}_{2}+\boldsymbol{{\beta}}}\left(\mathbf{y }\middle|\boldsymbol{{\Omega}}\right)\theta\genfrac{[}{]}{0.0pt}{}{\mathbf{c}_ {3}+\boldsymbol{{\alpha}}}{\mathbf{d}_{3}+\boldsymbol{{\beta}}}\left(\mathbf{u }\middle|\boldsymbol{{\Omega}}\right)\theta\genfrac{[}{]}{0.0pt}{}{\mathbf{c}_ {4}+\boldsymbol{{\alpha}}}{\mathbf{d}_{4}+\boldsymbol{{\beta}}}\left(\mathbf{v }\middle|\boldsymbol{{\Omega}}\right)</Math>.
</sentence>

</para>
  
</paragraph>
 
</subsection>
 
<subsection xml:id="C21.S6.SS2">
<title>Addition Formulas</title>        
  
<para xml:id="C21.S6.SS2.p1">

<sentence sentence-num-in-para="1" sentence-num-in-section="13" xml:id="C21.S6.SS2.p1.s1">
Let <Math mode="inline" xml:id="C21.S6.SS2.p1.m1">\boldsymbol{{\alpha}}</Math> , <Math mode="inline" xml:id="C21.S6.SS2.p1.m2">\boldsymbol{{\beta}}</Math> , <Math mode="inline" xml:id="C21.S6.SS2.p1.m3">\boldsymbol{{\gamma}}</Math> , <Math mode="inline" xml:id="C21.S6.SS2.p1.m4">\boldsymbol{{\delta}}\in{\mathbb{R}^{g}}</Math>.
</sentence>

<sentence sentence-num-in-para="2" sentence-num-in-section="14" xml:id="C21.S6.SS2.p1.s2">
Then <Math equation-number="21.6.8" mode="display" xml:id="C21.S6.E8">\theta\genfrac{[}{]}{0.0pt}{}{\boldsymbol{{\alpha}}}{\boldsymbol{{\gamma}}} \left(\mathbf{z}_{1}\middle|\boldsymbol{{\Omega}}\right)\theta\genfrac{[}{]}{0 .0pt}{}{\boldsymbol{{\beta}}}{\boldsymbol{{\delta}}}\left(\mathbf{z}_{2} \middle|\boldsymbol{{\Omega}}\right)=\sum_{\boldsymbol{{\nu}}\in{\mathbb{Z}^{g }}/\left(2{\mathbb{Z}^{g}}\right)}\theta\genfrac{[}{]}{0.0pt}{}{\frac{1}{2}[ \boldsymbol{{\alpha}}+\boldsymbol{{\beta}}+\boldsymbol{{\nu}}]}{\boldsymbol{{ \gamma}}+\boldsymbol{{\delta}}}\left(\mathbf{z}_{1}+\mathbf{z}_{2}\middle|2 \boldsymbol{{\Omega}}\right)\*\theta\genfrac{[}{]}{0.0pt}{}{\frac{1}{2}[ \boldsymbol{{\alpha}}-\boldsymbol{{\beta}}+\boldsymbol{{\nu}}]}{\boldsymbol{{ \gamma}}-\boldsymbol{{\delta}}}\left(\mathbf{z}_{1}-\mathbf{z}_{2}\middle|2 \boldsymbol{{\Omega}}\right)</Math>.
</sentence>

<sentence sentence-num-in-para="3" sentence-num-in-section="15" xml:id="C21.S6.SS2.p1.s3">
Thus <Math mode="inline" xml:id="C21.S6.SS2.p1.m5">\boldsymbol{{\nu}}</Math> is a <Math mode="inline" xml:id="C21.S6.SS2.p1.m6">g</Math> -dimensional vector whose entries are either <Math mode="inline" xml:id="C21.S6.SS2.p1.m7">0</Math> or <Math mode="inline" xml:id="C21.S6.SS2.p1.m8">1</Math>.
</sentence>

<sentence sentence-num-in-para="4" sentence-num-in-section="16" xml:id="C21.S6.SS2.p1.s4">
For this result and a generalization see Koizumi (1976) andBelokolos et al. (1994, pp. 38–41).
</sentence>

<sentence sentence-num-in-para="5" sentence-num-in-section="17" xml:id="C21.S6.SS2.p1.s5">
For addition formulas for classicaltheta functions see §20.7(ii).
</sentence>

</para>

 
</subsection>
 
</section>
